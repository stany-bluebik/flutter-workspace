"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.addPluginToNxJson = void 0;
const devkit_1 = require("@nx/devkit");
function addPluginToNxJson(pluginName, tree, ...cacheableOperations) {
    var _a, _b, _c;
    var _d, _e;
    const nxJson = (0, devkit_1.readJson)(tree, 'nx.json');
    nxJson.plugins = nxJson.plugins || [];
    if (!nxJson.plugins.includes(pluginName)) {
        nxJson.plugins.push(pluginName);
    }
    (_a = nxJson.targetDefaults) !== null && _a !== void 0 ? _a : (nxJson.targetDefaults = {});
    for (const target of cacheableOperations) {
        (_b = (_d = nxJson.targetDefaults)[target]) !== null && _b !== void 0 ? _b : (_d[target] = {});
        (_c = (_e = nxJson.targetDefaults[target]).cache) !== null && _c !== void 0 ? _c : (_e.cache = true);
    }
    (0, devkit_1.writeJson)(tree, 'nx.json', nxJson);
}
exports.addPluginToNxJson = addPluginToNxJson;
//# sourceMappingURL=add-plugin-to-nx-json.js.map